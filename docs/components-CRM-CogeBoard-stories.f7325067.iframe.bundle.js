"use strict";(self.webpackChunkcortex_react_components=self.webpackChunkcortex_react_components||[]).push([[17893],{"./src/components/CRM/CogeBoard.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,NoDeals:()=>NoDeals,Test:()=>Test,__namedExportsOrder:()=>__namedExportsOrder,default:()=>CogeBoard_stories});var jsx_runtime=__webpack_require__("./node_modules/.pnpm/next@15.1.3_@babel+core@7.26.0_@opentelemetry+api@1.9.0_react-dom@19.0.0_react@19.0.0__react@19.0.0_sass@1.83.0/node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/.pnpm/next@15.1.3_@babel+core@7.26.0_@opentelemetry+api@1.9.0_react-dom@19.0.0_react@19.0.0__react@19.0.0_sass@1.83.0/node_modules/next/dist/compiled/react/index.js"),DealDetails=__webpack_require__("./src/components/CRM/DealDetails.tsx"),KanbanColumn=__webpack_require__("./src/components/CRM/KanbanColumn.tsx"),drag_drop_context=__webpack_require__("./node_modules/.pnpm/@atlaskit+pragmatic-drag-and-drop-react-beautiful-dnd-migration@1.3.1_@types+react@19.0_fa0a46fbc9e35eb04bc27e0f9d454020/node_modules/@atlaskit/pragmatic-drag-and-drop-react-beautiful-dnd-migration/dist/esm/drag-drop-context/index.js");const gcstatuses=["firm","forecast","other"];function CRMCogeBoard({initialData,updateDeal,addComment}){const[selectedDeal,setSelectedDeal]=(0,react.useState)(null),calculateColumnValue=deals=>deals.reduce(((sum,deal)=>sum+(deal.value||0)),0),calculateWeightedValue=(deals,status)=>{const weightMap={Cold:0,Qualified:.1,"Proposal Made":.25,"SoW Submitted":.8,Won:1,Lost:0};return deals.reduce(((sum,deal)=>{var _weightMap_deal_status;return sum+(deal.value||0)*(null!==(_weightMap_deal_status=weightMap[deal.status])&&void 0!==_weightMap_deal_status?_weightMap_deal_status:0)}),0)},onDragEnd=(0,react.useCallback)((result=>{var _initialData_deals;const{source,destination}=result;if(!destination)return;if(source.droppableId===destination.droppableId&&source.index===destination.index)return;source.droppableId;const destinationStatus=destination.droppableId;let movedDeal=null===(_initialData_deals=initialData.deals)||void 0===_initialData_deals?void 0:_initialData_deals.filter((deal=>deal.id===source.index))[0];var _initialData_deals1;_initialData_deals1=initialData.deals;movedDeal&&(movedDeal.gecoStatus=destinationStatus,updateDeal(movedDeal))}),[updateDeal]);var _initialData_categories;return(0,jsx_runtime.jsx)(drag_drop_context.J,{onDragEnd,children:(0,jsx_runtime.jsxs)("div",{className:"flex flex-col p-4 overflow-hidden",style:{height:"calc(100% - 60px)"},children:[(0,jsx_runtime.jsx)("div",{className:"flex space-x-4 pb-4",children:gcstatuses.map((status=>{const deals=(status=>{var _initialData_deals;return(null!==(_initialData_deals=initialData.deals)&&void 0!==_initialData_deals?_initialData_deals:[]).filter((deal=>deal.gecoStatus===status)).filter((deal=>"Lost"!==deal.status)).filter((deal=>"Cold"!==deal.status))})(status);var _initialData_customers,_initialData_categories;return(0,jsx_runtime.jsx)(KanbanColumn.m,{status,deals,customers:null!==(_initialData_customers=initialData.customers)&&void 0!==_initialData_customers?_initialData_customers:[],users:initialData.users,categories:null!==(_initialData_categories=initialData.categories)&&void 0!==_initialData_categories?_initialData_categories:[],onDealClick:setSelectedDeal,calculateColumnValue,calculateWeightedValue,compact:!0},status)}))}),selectedDeal&&(0,jsx_runtime.jsx)(DealDetails.l,{deal:selectedDeal,users:initialData.users,customer:selectedDeal.customer,categories:null!==(_initialData_categories=initialData.categories)&&void 0!==_initialData_categories?_initialData_categories:[],onClose:()=>setSelectedDeal(null),onSave:updateDeal,onAddComment:comment=>addComment(selectedDeal.id.toString(),comment)})]})})}CRMCogeBoard.__docgenInfo={description:"",methods:[],displayName:"CRMCogeBoard",props:{initialData:{required:!0,tsType:{name:"signature",type:"object",raw:"{\n  deals?: Deal[]\n  users?: User[]\n  customers?: Customer[]\n  categories?: DealCategory[]\n}",signature:{properties:[{key:"deals",value:{name:"Array",elements:[{name:"Deal"}],raw:"Deal[]",required:!1}},{key:"users",value:{name:"Array",elements:[{name:"User"}],raw:"User[]",required:!1}},{key:"customers",value:{name:"Array",elements:[{name:"Customer"}],raw:"Customer[]",required:!1}},{key:"categories",value:{name:"Array",elements:[{name:"DealCategory"}],raw:"DealCategory[]",required:!1}}]}},description:""},updateDeal:{required:!0,tsType:{name:"signature",type:"function",raw:"(updatedDeal: Partial<EditableDeal>) => Promise<{ success: boolean; errors?: Record<string, string> }>",signature:{arguments:[{type:{name:"Partial",elements:[{name:"intersection",raw:"Omit<Partial<Deal>, 'comments' | 'customer'> & {\n  comments?: PartialComment[] | null;\n  customer: Partial<Customer> ;\n}",elements:[{name:"Omit",elements:[{name:"Partial",elements:[{name:"Deal"}],raw:"Partial<Deal>"},{name:"union",raw:"'comments' | 'customer'",elements:[{name:"literal",value:"'comments'"},{name:"literal",value:"'customer'"}]}],raw:"Omit<Partial<Deal>, 'comments' | 'customer'>"},{name:"signature",type:"object",raw:"{\n  comments?: PartialComment[] | null;\n  customer: Partial<Customer> ;\n}",signature:{properties:[{key:"comments",value:{name:"union",raw:"PartialComment[] | null",elements:[{name:"Array",elements:[{name:"Partial",elements:[{name:"NonNullable[number]",raw:"NonNullable<Deal['comments']>[number]"}],raw:"Partial<NonNullable<Deal['comments']>[number]>"}],raw:"PartialComment[]"},{name:"null"}],required:!1}},{key:"customer",value:{name:"Partial",elements:[{name:"Customer"}],raw:"Partial<Customer>",required:!0}}]}}]}],raw:"Partial<EditableDeal>"},name:"updatedDeal"}],return:{name:"Promise",elements:[{name:"signature",type:"object",raw:"{ success: boolean; errors?: Record<string, string> }",signature:{properties:[{key:"success",value:{name:"boolean",required:!0}},{key:"errors",value:{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>",required:!1}}]}}],raw:"Promise<{ success: boolean; errors?: Record<string, string> }>"}}},description:""},addComment:{required:!0,tsType:{name:"signature",type:"function",raw:"(dealId: string, comment: PartialComment) => Promise<{ success: boolean; errors?: Record<string, string> }>",signature:{arguments:[{type:{name:"string"},name:"dealId"},{type:{name:"Partial",elements:[{name:"NonNullable[number]",raw:"NonNullable<Deal['comments']>[number]"}],raw:"Partial<NonNullable<Deal['comments']>[number]>"},name:"comment"}],return:{name:"Promise",elements:[{name:"signature",type:"object",raw:"{ success: boolean; errors?: Record<string, string> }",signature:{properties:[{key:"success",value:{name:"boolean",required:!0}},{key:"errors",value:{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>",required:!1}}]}}],raw:"Promise<{ success: boolean; errors?: Record<string, string> }>"}}},description:""}}};var mockData=__webpack_require__("./src/components/CRM/mockData.ts"),console=__webpack_require__("./node_modules/.pnpm/console-browserify@1.2.0/node_modules/console-browserify/index.js");const CogeBoard_stories={title:"CRM/CogeBoard",tags:["autodocs"],component:CRMCogeBoard},Template=args=>{const[boardData,setBoardData]=(0,react.useState)(args.initialData);return(0,jsx_runtime.jsx)(CRMCogeBoard,{...args,initialData:boardData,updateDeal:async updatedDeal=>(console.log("Updating deal:",updatedDeal),setBoardData((prevData=>{var _prevData_deals;return{...prevData,deals:(null!==(_prevData_deals=prevData.deals)&&void 0!==_prevData_deals?_prevData_deals:[]).map((deal=>deal.id===updatedDeal.id?updatedDeal:deal))}})),updatedDeal)})},Default=Template.bind({});Default.args={initialData:{deals:Array.from({length:13},((_,i)=>({id:i+1,customer:mockData.Qd[i%mockData.Qd.length],value:Math.floor(1e5*Math.random())+5e3,assignee:mockData.rB[Math.floor(Math.random()*mockData.rB.length)].name,status:["Cold","Qualified","Proposal Made","Won","Lost"][Math.floor(5*Math.random())],gecoStatus:["firm","forecast","other"][i%3],categories:[mockData.zA[i%mockData.zA.length].id],dateLogged:new Date(Date.now()-24*Math.floor(30*Math.random())*60*60*1e3).toISOString(),closureDate:new Date(Date.now()+24*Math.floor(90*Math.random())*60*60*1e3).toISOString(),comments:[],updatedAt:(new Date).toISOString(),description:`This is a mock description for deal ${i+1}. It's a ${["small","medium","large"][i%3]} deal with high potential.`}))),customers:mockData.Qd,users:mockData.rB,categories:mockData.zA},addComment:async(dealId,comment)=>(console.log("Adding comment to deal:",dealId,comment),{...comment,id:"new-comment-id"})};const Test=Template.bind({});Test.args={...Default.args,initialData:{deals:[{id:11,customer:{id:1,name:"Customer 1",intro:null,active:!0,icon:null,updatedAt:"2025-04-28T21:56:26.595Z",createdAt:"2025-04-28T21:56:26.594Z"},value:1,assignee:{id:1,name:"Test user - do not delete",email:"test@test.com",jobRole:null,manager:null,about:null,profilePicture:null,holidaysRemaining:25,startingHolidays:25,dateOfBirth:null,joinDate:null,linkedIn:null,assets:[],role:"admin",updatedAt:"2025-04-28T21:23:55.792Z",createdAt:"2025-04-28T21:23:55.787Z",enableAPIKey:null,apiKey:null},status:"Won",gecoStatus:"firm",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"wewewewewedsds",comments:[],updatedAt:"2025-06-17T11:54:01.228Z",createdAt:"2025-04-29T21:09:20.627Z"},{id:10,value:1,status:"Lost",gecoStatus:"other",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"Lost deal example",comments:[],updatedAt:"2025-04-29T21:09:18.942Z",createdAt:"2025-04-29T21:09:18.940Z"},{id:9,value:1,status:"Cold",gecoStatus:"other",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"wewewewewedsds",comments:[],updatedAt:"2025-04-29T21:09:17.611Z",createdAt:"2025-04-29T21:09:17.601Z"},{id:8,value:1,status:"Cold",gecoStatus:"other",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"wewewewewedsds",comments:[],updatedAt:"2025-04-29T21:09:15.980Z",createdAt:"2025-04-29T21:09:15.979Z"},{id:7,value:1,status:"Cold",gecoStatus:"other",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"wewewewewedsds",comments:[],updatedAt:"2025-04-29T21:09:14.452Z",createdAt:"2025-04-29T21:09:14.442Z"},{id:6,value:1,status:"Cold",gecoStatus:"other",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"wewewewewedsds",comments:[],updatedAt:"2025-04-29T21:09:12.527Z",createdAt:"2025-04-29T21:09:12.526Z"},{id:5,value:1,status:"Cold",gecoStatus:"other",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"wewewewewedsds",comments:[],updatedAt:"2025-04-29T21:09:10.603Z",createdAt:"2025-04-29T21:09:10.592Z"},{id:4,value:1,status:"Cold",gecoStatus:"other",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"wewewewewedsds",comments:[],updatedAt:"2025-04-29T21:09:09.032Z",createdAt:"2025-04-29T21:09:09.031Z"},{id:3,value:1,status:"Cold",gecoStatus:"other",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"wewewewewedsds",comments:[],updatedAt:"2025-04-29T21:09:07.464Z",createdAt:"2025-04-29T21:09:07.463Z"},{id:2,value:1,status:"Cold",gecoStatus:"other",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"wewewewewedsds",comments:[],updatedAt:"2025-04-29T21:09:03.844Z",createdAt:"2025-04-29T21:09:03.840Z"},{id:1,value:1,status:"Cold",gecoStatus:"other",categories:[],dateLogged:"2025-04-29T21:08:45.154Z",closureDate:"2025-04-30T00:00:00.000Z",description:"wewewewewedsds",comments:[],updatedAt:"2025-04-29T21:08:45.164Z",createdAt:"2025-04-29T21:08:45.160Z"}],customers:[{id:1,name:"Customer 1",active:!0},{id:2,name:"Customer 2",active:!0},{id:3,name:"Customer 3",active:!0}],users:[{id:1,name:"Test user - do not delete",email:"test@test.com",jobRole:null,manager:null,about:null,profilePicture:null,holidaysRemaining:25,startingHolidays:25,dateOfBirth:null,joinDate:null,linkedIn:null,assets:[],role:"admin",updatedAt:"2025-04-28T21:23:55.792Z",createdAt:"2025-04-28T21:23:55.787Z",enableAPIKey:null,apiKey:null}],categories:[]}};const NoDeals=Template.bind({});NoDeals.args={...Default.args,initialData:{...Default.args.initialData,deals:[]}};const __namedExportsOrder=["Default","Test","NoDeals"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => {\n  const [boardData, setBoardData] = useState<BoardData>(args.initialData);\n  const handleUpdateDeal = async (updatedDeal: Deal) => {\n    console.log('Updating deal:', updatedDeal);\n    setBoardData(prevData => ({\n      ...prevData,\n      deals: (prevData.deals ?? []).map(deal => deal.id === updatedDeal.id ? updatedDeal : deal)\n    }));\n    return updatedDeal;\n  };\n  return <CRMCogeBoard {...args} initialData={boardData} updateDeal={handleUpdateDeal} />;\n}",...Default.parameters?.docs?.source}}},Test.parameters={...Test.parameters,docs:{...Test.parameters?.docs,source:{originalSource:"args => {\n  const [boardData, setBoardData] = useState<BoardData>(args.initialData);\n  const handleUpdateDeal = async (updatedDeal: Deal) => {\n    console.log('Updating deal:', updatedDeal);\n    setBoardData(prevData => ({\n      ...prevData,\n      deals: (prevData.deals ?? []).map(deal => deal.id === updatedDeal.id ? updatedDeal : deal)\n    }));\n    return updatedDeal;\n  };\n  return <CRMCogeBoard {...args} initialData={boardData} updateDeal={handleUpdateDeal} />;\n}",...Test.parameters?.docs?.source}}},NoDeals.parameters={...NoDeals.parameters,docs:{...NoDeals.parameters?.docs,source:{originalSource:"args => {\n  const [boardData, setBoardData] = useState<BoardData>(args.initialData);\n  const handleUpdateDeal = async (updatedDeal: Deal) => {\n    console.log('Updating deal:', updatedDeal);\n    setBoardData(prevData => ({\n      ...prevData,\n      deals: (prevData.deals ?? []).map(deal => deal.id === updatedDeal.id ? updatedDeal : deal)\n    }));\n    return updatedDeal;\n  };\n  return <CRMCogeBoard {...args} initialData={boardData} updateDeal={handleUpdateDeal} />;\n}",...NoDeals.parameters?.docs?.source}}}}}]);