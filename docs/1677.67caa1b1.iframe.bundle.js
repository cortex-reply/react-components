/*! For license information please see 1677.67caa1b1.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkcortex_react_components=self.webpackChunkcortex_react_components||[]).push([[1677],{"./src/components/CRM/DealDetails.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>DealDetails});var jsx_runtime=__webpack_require__("./node_modules/.pnpm/next@15.1.3_@babel+core@7.26.0_react-dom@19.0.0_react@19.0.0__react@19.0.0_sass@1.83.0/node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/.pnpm/next@15.1.3_@babel+core@7.26.0_react-dom@19.0.0_react@19.0.0__react@19.0.0_sass@1.83.0/node_modules/next/dist/compiled/react/index.js"),dialog=__webpack_require__("./src/components/ui/dialog.tsx"),ui_button=__webpack_require__("./src/components/ui/button.tsx"),input=__webpack_require__("./src/components/ui/input.tsx"),ui_label=__webpack_require__("./src/components/ui/label.tsx"),ui_textarea=__webpack_require__("./src/components/ui/textarea.tsx"),ui_select=__webpack_require__("./src/components/ui/select.tsx"),ui_checkbox=__webpack_require__("./src/components/ui/checkbox.tsx"),badge=__webpack_require__("./src/components/ui/badge.tsx"),scroll_area=__webpack_require__("./src/components/ui/scroll-area.tsx"),createLucideIcon=__webpack_require__("./node_modules/.pnpm/lucide-react@0.469.0_react@19.0.0/node_modules/lucide-react/dist/esm/createLucideIcon.js");(0,createLucideIcon.A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);const Save=(0,createLucideIcon.A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var user=__webpack_require__("./node_modules/.pnpm/lucide-react@0.469.0_react@19.0.0/node_modules/lucide-react/dist/esm/icons/user.js"),calendar=__webpack_require__("./node_modules/.pnpm/lucide-react@0.469.0_react@19.0.0/node_modules/lucide-react/dist/esm/icons/calendar.js"),plus=__webpack_require__("./node_modules/.pnpm/lucide-react@0.469.0_react@19.0.0/node_modules/lucide-react/dist/esm/icons/plus.js");function DealDetails({deal,users,customer,categories,onClose,onSave,onAddComment}){var _editedDeal_value;const[editedDeal,setEditedDeal]=(0,react.useState)({...deal,value:deal.value||0}),[newComment,setNewComment]=(0,react.useState)(""),[hasChanges,setHasChanges]=(0,react.useState)(!1),[editingField,setEditingField]=(0,react.useState)(null);(0,react.useEffect)((()=>{setHasChanges(JSON.stringify(deal)!==JSON.stringify(editedDeal))}),[deal,editedDeal]);const handleChange=(field,value)=>{setEditedDeal((prev=>({...prev,[field]:value})))},getCategoryColor=type=>{switch(type){case"proposition":return"bg-blue-100 text-blue-800";case"source":return"bg-green-100 text-green-800";case"sector":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return(0,jsx_runtime.jsx)(dialog.lG,{open:!0,children:(0,jsx_runtime.jsxs)(dialog.Cf,{className:"max-w-3xl max-h-[90vh] overflow-hidden flex flex-col [&>button:last-child]:hidden",children:[(0,jsx_runtime.jsxs)(dialog.c7,{className:"flex flex-row items-center justify-between",children:[(0,jsx_runtime.jsx)(dialog.L3,{className:"text-2xl font-bold",children:null==customer?void 0:customer.name}),(0,jsx_runtime.jsxs)("div",{className:"flex space-x-2",children:[(0,jsx_runtime.jsx)(ui_button.$,{variant:"outline",onClick:onClose,children:"Close"}),(0,jsx_runtime.jsxs)(ui_button.$,{onClick:()=>{onSave(editedDeal),setHasChanges(!1),setEditingField(null)},disabled:!hasChanges,children:[(0,jsx_runtime.jsx)(Save,{className:"w-4 h-4 mr-2"}),"Save"]})]})]}),(0,jsx_runtime.jsxs)(scroll_area.F,{className:"flex-grow pr-4",children:[(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,jsx_runtime.jsx)("div",{className:"grid gap-2",children:"value"===editingField?(0,jsx_runtime.jsx)(input.p,{type:"number",value:editedDeal.value,onChange:e=>handleChange("value",Number(e.target.value)),onBlur:()=>setEditingField(null),className:"text-3xl font-bold text-green-600",autoFocus:!0}):(0,jsx_runtime.jsxs)("div",{className:"text-3xl font-bold text-green-600 cursor-pointer hover:bg-gray-100 p-0 rounded",onClick:()=>setEditingField("value"),children:["Â£",null===(_editedDeal_value=editedDeal.value)||void 0===_editedDeal_value?void 0:_editedDeal_value.toLocaleString()]})}),(0,jsx_runtime.jsxs)("div",{className:"grid gap-2",children:[(0,jsx_runtime.jsx)(ui_label.J,{className:"text-sm font-medium text-gray-500",children:"Assignee"}),"assignee"===editingField?(0,jsx_runtime.jsxs)(ui_select.l6,{value:editedDeal.assignee,onValueChange:value=>handleChange("assignee",value),children:[(0,jsx_runtime.jsx)(ui_select.bq,{children:(0,jsx_runtime.jsx)(ui_select.yv,{placeholder:"Select assignee"})}),(0,jsx_runtime.jsx)(ui_select.gC,{children:users&&users.map((user=>(0,jsx_runtime.jsx)(ui_select.eb,{value:user.id.toString(),children:user.name},user.id)))})]}):(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-100 p-0 rounded",onClick:()=>setEditingField("assignee"),children:[(0,jsx_runtime.jsx)(user.A,{className:"w-4 h-4 text-gray-400"}),(0,jsx_runtime.jsx)("span",{children:editedDeal.assignee})]})]}),(0,jsx_runtime.jsxs)("div",{className:"grid gap-2",children:[(0,jsx_runtime.jsx)(ui_label.J,{className:"text-sm font-medium text-gray-500",children:"Closure Date"}),"closureDate"===editingField?(0,jsx_runtime.jsx)(input.p,{type:"date",value:editedDeal.closureDate.split("T")[0],onChange:e=>handleChange("closureDate",e.target.value),onBlur:()=>setEditingField(null),autoFocus:!0}):(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-100 p-0 rounded",onClick:()=>setEditingField("closureDate"),children:[(0,jsx_runtime.jsx)(calendar.A,{className:"w-4 h-4 text-gray-400"}),(0,jsx_runtime.jsx)("span",{children:new Date(editedDeal.closureDate).toLocaleDateString("en-GB")})]})]})]}),(0,jsx_runtime.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-1 gap-4",children:(0,jsx_runtime.jsxs)("div",{className:"grid gap-2",children:[(0,jsx_runtime.jsx)(ui_label.J,{className:"text-sm font-medium text-gray-500",children:"Description"}),"description"===editingField?(0,jsx_runtime.jsx)(ui_textarea.T,{value:editedDeal.description,onChange:e=>handleChange("description",e.target.value),onBlur:()=>setEditingField(null),className:"min-h-[100px]",autoFocus:!0}):(0,jsx_runtime.jsx)("div",{className:"cursor-pointer hover:bg-gray-100 pb-5 rounded",onClick:()=>setEditingField("description"),children:editedDeal.description})]})}),(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 pt-2 gap-4",children:[(0,jsx_runtime.jsxs)("div",{className:"grid gap-2",children:[(0,jsx_runtime.jsx)(ui_label.J,{className:"text-sm font-medium text-gray-500",children:"Status"}),"status"===editingField?(0,jsx_runtime.jsxs)(ui_select.l6,{value:editedDeal.status,onValueChange:value=>{handleChange("status",value),setEditingField(null)},children:[(0,jsx_runtime.jsx)(ui_select.bq,{children:(0,jsx_runtime.jsx)(ui_select.yv,{placeholder:"Select status"})}),(0,jsx_runtime.jsx)(ui_select.gC,{children:["Cold","Qualified","Proposal Made","Won","Lost"].map((status=>(0,jsx_runtime.jsx)(ui_select.eb,{value:status,children:status},status)))})]}):(0,jsx_runtime.jsx)("div",{className:"cursor-pointer hover:bg-gray-100 p-0 rounded",onClick:()=>setEditingField("status"),children:editedDeal.status})]}),(0,jsx_runtime.jsxs)("div",{className:"grid col-span-2 gap-2",children:[(0,jsx_runtime.jsx)(ui_label.J,{className:"text-sm font-medium text-gray-500",children:"Categories"}),"categories"===editingField?(0,jsx_runtime.jsx)("div",{className:"grid grid-cols-2 gap-2",children:categories.map((category=>(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jsx_runtime.jsx)(ui_checkbox.S,{id:category.id,checked:editedDeal.categories.includes(category.id),onCheckedChange:()=>(categoryId=>{const updatedCategories=editedDeal.categories.includes(categoryId)?editedDeal.categories.filter((id=>id!==categoryId)):[...editedDeal.categories,categoryId];handleChange("categories",updatedCategories)})(category.id)}),(0,jsx_runtime.jsx)("label",{htmlFor:category.id,className:`text-sm font-medium ${getCategoryColor(category.type)} px-2 py-1 rounded`,children:category.name})]},category.id)))}):(0,jsx_runtime.jsx)("div",{className:"flex flex-wrap gap-2 cursor-pointer hover:bg-gray-100 p-0 rounded",onClick:()=>setEditingField("categories"),children:editedDeal.categories.map((catId=>{const category=categories.find((c=>c.id===catId));return category?(0,jsx_runtime.jsx)(badge.E,{variant:"secondary",className:getCategoryColor(category.type),children:category.name},category.id):null}))})]})]}),(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-1 pt-4 gap-4",children:[(0,jsx_runtime.jsxs)("div",{className:"grid gap-2",children:[(0,jsx_runtime.jsx)(ui_label.J,{className:"text-sm font-medium text-gray-500",children:"Comments"}),(0,jsx_runtime.jsx)(scroll_area.F,{className:"h-[200px] overflow-y-auto",children:(0,jsx_runtime.jsx)("div",{className:"space-y-2",children:editedDeal.comments.map((comment=>(0,jsx_runtime.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,jsx_runtime.jsx)("p",{className:"text-sm text-gray-700",children:comment.text}),(0,jsx_runtime.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[comment.author," - ",new Date(comment.timestamp).toLocaleString()]})]},comment.id)))})}),(0,jsx_runtime.jsxs)("div",{className:"flex mt-2",children:[(0,jsx_runtime.jsx)(input.p,{value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:"Add a comment...",className:"flex-grow"}),(0,jsx_runtime.jsxs)(ui_button.$,{onClick:()=>{newComment.trim()&&(onAddComment({id:Date.now().toString(),text:newComment,timestamp:(new Date).toISOString()}),setNewComment(""))},className:"ml-2",children:[(0,jsx_runtime.jsx)(plus.A,{className:"w-4 h-4 mr-2"}),"Add"]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"text-xs text-gray-500 mt-4",children:["Last modified: ",new Date(editedDeal.lastModified).toLocaleString()]})]})]})]})})}DealDetails.__docgenInfo={description:"",methods:[],displayName:"DealDetails",props:{deal:{required:!0,tsType:{name:"signature",type:"object",raw:"{\n  id: string\n  customerId: string\n  value: number\n  assignee: string\n  status: Status\n  categories: string[]\n  dateLogged: string\n  closureDate: string\n  lastModified: string\n  comments: Comment[]\n  description: string\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"customerId",value:{name:"string",required:!0}},{key:"value",value:{name:"number",required:!0}},{key:"assignee",value:{name:"string",required:!0}},{key:"status",value:{name:"union",raw:'"Cold" | "Qualified" | "Proposal" | "SoW" | "Won" | "Lost"',elements:[{name:"literal",value:'"Cold"'},{name:"literal",value:'"Qualified"'},{name:"literal",value:'"Proposal"'},{name:"literal",value:'"SoW"'},{name:"literal",value:'"Won"'},{name:"literal",value:'"Lost"'}],required:!0}},{key:"categories",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0}},{key:"dateLogged",value:{name:"string",required:!0}},{key:"closureDate",value:{name:"string",required:!0}},{key:"lastModified",value:{name:"string",required:!0}},{key:"comments",value:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n  id: string\n  text: string\n  author?: string\n  timestamp: string\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"text",value:{name:"string",required:!0}},{key:"author",value:{name:"string",required:!1}},{key:"timestamp",value:{name:"string",required:!0}}]}}],raw:"Comment[]",required:!0}},{key:"description",value:{name:"string",required:!0}}]}},description:""},users:{required:!1,tsType:{name:"Array",elements:[{name:"User"}],raw:"User[]"},description:""},customer:{required:!0,tsType:{name:"union",raw:"Customer | undefined",elements:[{name:"signature",type:"object",raw:"{\n  id: string\n  name: string\n  intro?: string\n  active: boolean\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"intro",value:{name:"string",required:!1}},{key:"active",value:{name:"boolean",required:!0}}]}},{name:"undefined"}]},description:""},categories:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:'{\n  id: string\n  name: string\n  type: "proposition" | "source" | "sector"\n}',signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"type",value:{name:"union",raw:'"proposition" | "source" | "sector"',elements:[{name:"literal",value:'"proposition"'},{name:"literal",value:'"source"'},{name:"literal",value:'"sector"'}],required:!0}}]}}],raw:"Category[]"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onSave:{required:!0,tsType:{name:"signature",type:"function",raw:"(deal: Deal) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{\n  id: string\n  customerId: string\n  value: number\n  assignee: string\n  status: Status\n  categories: string[]\n  dateLogged: string\n  closureDate: string\n  lastModified: string\n  comments: Comment[]\n  description: string\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"customerId",value:{name:"string",required:!0}},{key:"value",value:{name:"number",required:!0}},{key:"assignee",value:{name:"string",required:!0}},{key:"status",value:{name:"union",raw:'"Cold" | "Qualified" | "Proposal" | "SoW" | "Won" | "Lost"',elements:[{name:"literal",value:'"Cold"'},{name:"literal",value:'"Qualified"'},{name:"literal",value:'"Proposal"'},{name:"literal",value:'"SoW"'},{name:"literal",value:'"Won"'},{name:"literal",value:'"Lost"'}],required:!0}},{key:"categories",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0}},{key:"dateLogged",value:{name:"string",required:!0}},{key:"closureDate",value:{name:"string",required:!0}},{key:"lastModified",value:{name:"string",required:!0}},{key:"comments",value:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n  id: string\n  text: string\n  author?: string\n  timestamp: string\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"text",value:{name:"string",required:!0}},{key:"author",value:{name:"string",required:!1}},{key:"timestamp",value:{name:"string",required:!0}}]}}],raw:"Comment[]",required:!0}},{key:"description",value:{name:"string",required:!0}}]}},name:"deal"}],return:{name:"void"}}},description:""},onAddComment:{required:!0,tsType:{name:"signature",type:"function",raw:"(comment: Comment) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{\n  id: string\n  text: string\n  author?: string\n  timestamp: string\n}",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"text",value:{name:"string",required:!0}},{key:"author",value:{name:"string",required:!1}},{key:"timestamp",value:{name:"string",required:!0}}]}},name:"comment"}],return:{name:"void"}}},description:""}}}}}]);